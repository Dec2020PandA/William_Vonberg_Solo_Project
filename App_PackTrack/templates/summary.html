<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Summary</title>
    {%load static%}
    <link rel="stylesheet" href="{%static 'pack_style.css'%}">
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Rock+Salt&display=swap" rel="stylesheet">
    <script src="{% static 'scripts.js'%}"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.slim.min.js"></script>
    </head>

<body id='summary-body'>
    <div class="navbar-main">
        <img id='logo-main' src="../static/images/PackTrack_Logo.png" alt="logo-main">

        <div id="packtrack-menu">
            <ul class="navbar-nav">
                <li><a href="/summary">Summary</a></li>
                <li><a href="/support">Support</a></li>
                <li><a href="/logout">Logout</a></li>
            </ul>
            <div id="spacer">
                <p><a id="user_active" href="/profile">{{request.session.user_name}}</a></p>
            </div>
        </div>
    </div>
    <div id="sum-spacer">

    </div>
    <div id="sum-main">
        <div id="profile-pics">
            <div id="gage-pic">
                {% if data.gender == "M" %}
                <img id="male-pic" src="../static/images/user_male.png" alt="male-profile-pic">
                {% else %}
                <img id="female-pic" src="../static/images/user_female.png" alt="female-profile-pic">
                {%endif%}
                <h3>{{user.first_name}}</h3>
            </div>
            <div id="gage-pic">
                <img id="pet-pic" src="../static/images/pet_pic.png" alt="pet-profile-pic">
                {%if dogs%}
                <select name="dog_selector" id="dog_selector" onchange="">
                    {%for dog in dogs%}
                    <option value="{{dog.id}}">{{dog.pet_name}}</option>
                    {%endfor%}
                </select>
                {%else%}
                <a id="selector-add" href="/add_dog">Add a Dog</a>
                {%endif%}
            </div>
        </div>
        <div id="move-back">
            <a id="arrow-l" href="">«</a>
        </div>
        <div id="data-bars">
            <h2>{{diary_date|date:"m-d-Y"}}</h2>
            <div id="user-gages">
                <div class="gages" id="gage1">
                    <h4>Calories</h4>
                    <h5>Current:</h5>
                    <div class="gage-current">
                        <p>XXXX</p>
                    </div>
                    <h5>Goal:</h5>
                    <div class="gage-goal">
                        <p>{{cal}}</p>
                    </div>
                </div>
                <div class="gages">
                    <h4>Fat</h4>
                    <h5>Current:</h5>
                    <div class="gage-current">
                        <p>XXXX</p>
                    </div>
                    <h5>Goal:</h5>
                    <div class="gage-goal">
                        <p>{{fat_goal}} g</p>
                    </div>
                </div>
                <div class="gages">
                    <h4>Carbs</h4>
                    <h5>Current:</h5>
                    <div class="gage-current">
                        <p>XXXX</p>
                    </div>
                    <h5>Goal:</h5>
                    <div class="gage-goal">
                        <p>{{carb_goal}} g</p>
                    </div>
                </div>
                <div class="gages">
                    <h4>Protein</h4>
                    <h5>Current:</h5>
                    <div class="gage-current">
                        <p>XXXX</p>
                    </div>
                    <h5>Goal:</h5>
                    <div class="gage-goal">
                        <p>{{prot_goal}} g</p>
                    </div>
                </div>
                <div class="gages">
                    <h4>Goal Weight</h4>
                    <h5>Current:</h5>
                    <div class="gage-current">
                        <p>{{data.current_weight}} lbs</p>
                    </div>
                    <h5>Goal:</h5>
                    <div class="gage-goal">
                        <p>{{data.goal}} lbs</p>
                    </div>
                </div>
            </div>
            <div id="pet-gages">
                {% if dogs %}
                <div class="pgages" id="gage2">
                    <h4>Calories</h4>
                    <h5>Current:</h5>
                    <div class="gage-current">
                        <p>XXXX</p>
                    </div>
                    <h5>Goal:</h5>
                    <div class="gage-goal">
                        <p><span id="dog_attr_petcal"></span></p>
                    </div>
                </div>
                <div class="pgages">
                    <h4>Fat</h4>
                    <h5>Current:</h5>
                    <div class="gage-current">
                        <p>XXXX</p>
                    </div>
                    <h5>Goal:</h5>
                    <div class="gage-goal">
                        <p><span id="dog_attr_pet_fat"></span> g</p>
                    </div>
                </div>
                <div class="pgages">
                    <h4>Carbs</h4>
                    <h5>Current:</h5>
                    <div class="gage-current">
                        <p>XXXX</p>
                    </div>
                    <h5>Goal:</h5>
                    <div class="gage-goal">
                        <p><span id="dog_attr_pet_carb"></span> g</p>
                    </div>
                </div>
                <div class="pgages">
                    <h4>Protein</h4>
                    <h5>Current:</h5>
                    <div class="gage-current">
                        <p>XXXX</p>
                    </div>
                    <h5>Goal:</h5>
                    <div class="gage-goal">
                        <p><span id="dog_attr_pet_prot"></span> g</p>
                    </div>
                </div>
                <div class="pgages">
                    <h4>Goal Weight</h4>
                    <h5>Current:</h5>
                    <div class="gage-current">
                        <p><span id="dog_attr_pet_weight"></span> lbs</p>
                    </div>
                    <h5>Goal:</h5>
                    <div class="gage-goal">
                        <p><span id="dog_attr_pet_goal"></span> lbs</p>
                    </div>
                </div>
                {% endif %}
            </div>
        </div>
        <div id="move-forward">
            <a id="arrow-r" href="">»</a>
        </div>
    </div>
    <div id="entries">
        <div class="diary" id="user-entry">
            <h2>{{request.session.user_name}}'s Entry</h2>
            <form id="user-diary-form" action="" method="post">
                {%csrf_token%}
                <div id="user-diary-food">
                    <div class="d-input">
                        <label for="food_item">Food Item:</label>
                        <input name="food_item" type="text" placeholder="What did you eat?"><br>
                    </div>
                    <div class="d-input">
                        <label for="calories">Calories:</label>
                        <input name="calories" type="number" value=0><br>
                    </div>
                    <div class="d-input">
                        <label for="fat">Fat:</label>
                        <input name="fat" type="number" value=0><br>
                    </div>
                    <div class="d-input">
                        <label for="carbs">Carbs</label>
                        <input name="carbs" type="number" value=0><br>
                    </div>
                    <div class="d-input">
                        <label for="protein">Protein</label>
                        <input name="protein" type="number" value=0>
                    </div>
                </div>
                <div id="user-diary-activity">
                    <div class="d-input" id="da-input">
                        <label for="activity">Activity:</label>
                        <input name="activity" type="text" placeholder="What did you do?"><br>
                    </div>
                    <div class="d-input">
                        <label for="calories_burned">Calories Burned:</label>
                        <input name="calories_burned" type="number" value=0><br>
                    </div>
                </div>
                <input class="btn" id="submit-btn" type="submit" value="Submit Entry">
            </form>
        </div>
        <div class="diary" id="pet-entry">
            {% if dogs %}
                <h2><span id="dog_attr_pet_name"></span>'s Entry</h2>
            {% else %}
                <h2><a href="/add_dog">Add a Dog</a></h2>
            {% endif %}
            {% if dogs %}
            <form id="dog-diary-form" action="" method="post">
                {%csrf_token%}
                <div id="user-diary-food">
                    <div class="d-input">
                        <label for="pet_food">Pet's Food Item:</label>
                        <input name="pet_food" type="text" placeholder="What did fido eat?"><br>
                    </div>
                    <div class="d-input">
                        <label for="pet_cals">Calories:</label>
                        <input name="pet_cals" type="number" value=0><br>
                    </div>
                    <div class="d-input">
                        <label for="pet_fat">Fat:</label>
                        <input name="pet_fat" type="number" value=0><br>
                    </div>
                    <div class="d-input">
                        <label for="pet_carbs">Carbs</label>
                        <input name="pet_carbs" type="number" value=0><br>
                    </div>
                    <div class="d-input">
                        <label for="pet_protein">Protein</label>
                        <input name="pet_protein" type="number" value=0>
                    </div>
                </div>
                <div id="user-diary-activity">
                    <div class="d-input" id="da-input">
                        <label for="pet_activity">Activity:</label>
                        <input name="pet_activity" type="text" placeholder="What did fido do?"><br>
                    </div>
                    <div class="d-input">
                        <label for="calories_burned">Calories Burned:</label>
                        <input name="calories_burned" type="number" value=0><br>
                    </div>
                </div>
                <input class="btn" id="submit-btn" type="submit" value="Submit Entry">
            </form>
            {% endif %}
        </div>
    </div>
    <div id="diary-list">
        <div class="list" id="user-list">
            <p>human data</p>
        </div>
        <div class="list" id="pet-list">
            <p>pet data</p>
        </div>
    </div>
    <script>
        // This is the blob you want to dynamically generate in your template
        dog_data = {
            {% for dog in dogs %}
                '{{dog.id}}': {
                    'pet_name': '{{ dog.pet_name }}',
                    'petcal': '{{dog.mer}}',
                    'pet_goal': '{{dog.pet_goal}}',
                    'pet_fat': '{{dog.petFat}}',
                    'pet_carb': '{{dog.petCarb}}',
                    'pet_prot': '{{dog.petProt}}',
                    'pet_weight': '{{dog.pet_weight}}',

                }{% if not forloop.last %},{% endif %} // this prevents extra commas that sometimes cause syntax errors
            {% endfor %}
        }

        function handle_dog_selector() {
            dog_id = $("#dog_selector option:selected").attr('value') // Get selected dog id
            my_data = dog_data[dog_id] // Get the data from the dog data object
            for (const [key, value] of Object.entries(my_data)) { // Loop over the dog data key-values
                $("#dog_attr_"+key).text(value) // Populate any spans whose IDs match the key
            }
        }

        $('#dog_selector').change(handle_dog_selector) // Populate the selected dog's stats on change
        $(document).ready(handle_dog_selector) // Populate the selected dog's stats on page load
    </script>

</body>

</html>